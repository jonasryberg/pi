
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Webbstyrd pi-kamera - Jonas@pi</title>
  <meta name="author" content="Jonas Ryberg">

  
  <meta name="description" content="Regning oktoberlördag. Barnen är på utflykt och jag och min bror biologen bestämmer oss för att leka med Raspeberry Pi-cam. Tanken är att bygga en &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://pi.ryberg.org/blog/2013/10/26/webbstyrd-pi-kamera">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Jonas@pi" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-46864965-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Jonas@pi</a></h1>
  
    <h2>Bloggade nörderier.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:pi.ryberg.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blogg</a></li>
  <li><a href="/blog/archives">Arkiv</a></li>
  <li><a href="/om">Om bloggen</a></li>
  <li><a href="/om/mig.html">Om mig</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Webbstyrd pi-kamera</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-10-26T14:06:59+00:00" pubdate data-updated="true">2013-10-26</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>Regning oktoberlördag. Barnen är på utflykt och jag och <a href="http://www.anst.uu.se/marry118/">min bror biologen</a> bestämmer oss för att leka med Raspeberry Pi-cam. Tanken är att bygga en kamera som vi kan styra via en webbsida. Första steget är att installera en webbserver. Efter att ha strulat en bra stund med lighttpd, eftersom den enligt internets samlade visdom kräver mindre resurser än klassiska Apache, så väljer vi i alla fall Apache då den ger felmeddelanden som faktiskt kan tolkas.</p>

<!-- more -->


<pre><code>sudo apt-get install apache
</code></pre>

<p>tar hand om att installera Apache-servern på pi:n.
För att testa om det fungerat är det bra att surfa in till Raspberryn från en annan dator. Att kolla den lokala ip-adressen görs enkelt i</p>

<pre><code>/sbin/ifconfig
</code></pre>

<p>Om allt fungerat ska du se en testsida från Apache.</p>

<p>Fungerar allt som det ska är det dags för nästa steg, att skapa en webbsida som kan användas för att styra Raspberry Cam. På Raspberry Pi skapar vi en fil som heter kamera.html med</p>

<pre><code>sudo nano kamera.html
</code></pre>

<p>I Nano bygger vi först en enkel sida med en kameraknapp som sedan ska starta ett Perl-script som kan styra kameran. Vi använder &ldquo;form&rdquo; för att senare kunna lägga till olika parametrar till raspistill, kommandot som sköter pi-kameran.</p>

<pre><code>&lt;html&gt;

&lt;form method="get" action="/cgi-bin/kamera.cgi"&gt;
&lt;input type="submit" value="Ta bild"&gt;
&lt;/form&gt;

&lt;/html&gt;
</code></pre>

<p>Sidan sparar vi i www-foldern för att Apache ska kunna hitta den.</p>

<p>Nästa steg är att skapa ett Perl-script som kan ta bilder. Det visade sig vara ganska krångligt att få att fungera med rättigheterna som krävs för att kameramodulen ska kunna spara bilden. Men till slut fungerade det <a href="http://fc07.deviantart.net/fs71/i/2012/116/4/f/great_success_by_merionminor-d4xmjry.png">Great success!</a></p>

<p>Lösningen blev att lägga till www-data som sudo utan lösenord och känns inte helt tillfredsställande.</p>

<p>Perl-scriptet i kamera.cgi blev så här:</p>

<pre><code>#! /usr/bin/perl

use strict;
print "Content-type: text/html\n\n";
print "&lt;html&gt;";
system "sudo /usr/bin/raspistill -o \"/var/www/bild.jpg\" -vf -n;
print '&lt;img src="/bild.jpg"&gt;';
print "&lt;/html&gt;";
</code></pre>

<p>Glöm inte heller att köra chmod +x på filen för att den ska kunna köras av webbservern.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Jonas Ryberg</span></span>

      








  


<time datetime="2013-10-26T14:06:59+00:00" pubdate data-updated="true">2013-10-26</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/raspberry-pi/'>Raspberry_pi</a>, <a class='category' href='/blog/categories/foto/'>foto</a>, <a class='category' href='/blog/categories/perl/'>perl</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://pi.ryberg.org/blog/2013/10/26/webbstyrd-pi-kamera/" data-via="ryberg" data-counturl="http://pi.ryberg.org/blog/2013/10/26/webbstyrd-pi-kamera/" >Tweet</a>
  
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2013/07/18/leverans-av-liten-bit/" title="Previous Post: Leverans av liten bit">&laquo; Leverans av liten bit</a>
      
      
        <a class="basic-alignment right" href="/blog/2013/11/10/intervallfoto-2-0/" title="Next Post: Intervallfoto 2.0">Intervallfoto 2.0 &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Nypublicerat</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/02/09/python-piglow-och-utomhustemperatur/">Python, PiGlow och utomhustemperatur</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/01/25/rovarspraket-i-Python/">Rövarspråket i Python</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/01/07/nypressat-schackintresse/">Nypressat schackintresse</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/01/05/ir-foto-med-pi-n/">Ir-foto med pi:n</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/10/intervallfoto-2-0/">Intervallfoto 2.0</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Jonas Ryberg -
  <span class="credit">Tillagad med <a href="http://octopress.org">Octopress</a>, serverad på <a href="http://github.com">Github</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'piryberg';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://pi.ryberg.org/blog/2013/10/26/webbstyrd-pi-kamera/';
        var disqus_url = 'http://pi.ryberg.org/blog/2013/10/26/webbstyrd-pi-kamera/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
